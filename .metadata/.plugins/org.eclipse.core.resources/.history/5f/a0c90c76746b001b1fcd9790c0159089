/*
 * generated by Xtext 2.14.0
 */
package polytech.spaceteam.cineditor.validation

import org.eclipse.xtext.validation.Check
import CinEditorML.CinEditorMLPackage
import CinEditorML.Movie
import java.util.regex.Pattern
import CinEditorML.Shape
import CinEditorML.Element

/**
 * This class contains custom validation rules. 
 *
 * See https://www.eclipse.org/Xtext/documentation/303_runtime_concepts.html#validation
 */
class CinEditorValidator extends AbstractCinEditorValidator {
	
	public static val INVALID_POSITION = 'invalidPosition'
	public static val INVALID_COLOR = 'invalidColor'
	public static val INVALID_DURATION = 'invalidDuration'

	@Check
	def checkMoviePosition(Movie movie) {
		if (movie.dimension.width < 0) {
			error('Movie width must be > 0', 
					CinEditorMLPackage.Literals.MOVIE__DIMENSION,
					INVALID_POSITION)
		}
		if (movie.dimension.height < 0) {
			error('Movie height must be > 0', 
					CinEditorMLPackage.Literals.MOVIE__DIMENSION,
					INVALID_POSITION)
		}
	}
	
	@Check
	def checkElementDuration(Element element) {
 		if (element.duration < 0) {
 			error('Element duration must be > 0', 
					CinEditorMLPackage.Literals.ELEMENT__DURATION,
					INVALID_DURATION)
 		}
	}
	
	@Check
	def checkShapeColor(Shape shape) {
		val p = Pattern.compile("^([a-fA-F0-9]{6}|[a-fA-F0-9]{3})$");      
		val m = p.matcher(shape.hexadecimalValue) ;    
 		var b = m.matches();
 		if (!b) {
 			error('Shape color must be in hexadecimal', 
					CinEditorMLPackage.Literals.SHAPE__HEXADECIMAL_VALUE,
					INVALID_COLOR)
 		}
	}
	
}
